!function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k){this.canvas=document.getElementById("schedule"),this.context=this.canvas.getContext("2d"),this.left=a,this.right=b,this.top=c,this.bottom=d,this.size=e,this.data=f,this.values=g,this.row=h,this.fill=j,this.stroke=k,this.time=i,this.focus=!0,this.show=function(){this.context.save(),this.context.beginPath(),this.context.rect(this.left,this.top,this.right-this.left,this.size),this.context.lineWidth=1,this.context.strokeStyle="rgba("+this.stroke+","+(this.focus?1:.25)+")",this.context.stroke(),this.context.fillStyle="rgba("+this.fill+","+(this.focus?.5:.15)+")",this.context.fill(),this.context.closePath();var a,b;this.context.beginPath(),this.context.font="10pt Calibri",this.context.fillStyle="rgba(45, 49, 66, "+(this.focus?1:.25)+")",a=(this.right-this.left)/2+this.left-this.context.measureText(this.values.label).width/2,b=(this.top-this.bottom)/2+this.bottom+5,this.values.label.indexOf("y")!=-1&&(b-=this.size/10),this.context.fillText(this.values.label,a,b),this.context.closePath(),this.context.restore()},this.tooltip=function(a,b){var c=this.formatTime(l,m),d=this.context.measureText(c).width+25,e=25,f=a-d-2,g=b-e,h=5,i=f+5,j=e+g-5-2;this.context.save(),this.context.fillStyle="rgba(0, 0, 0, .5)",this.context.strokeStyle="rgba(0, 0, 0, 1)",this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(f+h,g),this.context.lineTo(f+d-h,g),this.context.quadraticCurveTo(f+d,g,f+d,g+h),this.context.lineTo(f+d,g+e-h),this.context.quadraticCurveTo(f+d,g+e,f+d-h,g+e),this.context.lineTo(f+h,g+e),this.context.quadraticCurveTo(f,g+e,f,g+e-h),this.context.lineTo(f,g+h),this.context.quadraticCurveTo(f,g,f+h,g),this.context.closePath(),this.context.stroke(),this.context.fill(),this.context.beginPath(),this.context.font="10pt Calibri",this.context.fillStyle="rgba(255, 255, 255, 1)",this.context.fillText(c,i,j),this.context.closePath(),this.context.restore()},this.formatTime=function(a,b){var c;if(0==this.time){var d=a.getHours(),e=a.getMinutes();e=e<10?"0"+e:e;var f=d<=12?"am":"pm";"pm"==f&&(d-=12);var g=d+":"+e+" "+f;d=b.getHours(),e=b.getMinutes(),e=e<10?"0"+e:e,f=d<=12?"am":"pm","pm"==f&&(d-=12);var h=d+":"+e+" "+f;c=g+" til "+h}if(1==this.time){var d=a.getHours(),e=a.getMinutes();e=e<10?"0"+e:e;var g=d+":"+e;d=b.getHours(),e=b.getMinutes(),e=e<10?"0"+e:e;var h=d+":"+e;c=g+" til "+h}return c};var l=new Date(1e3*this.values.start+6e4*(new Date).getTimezoneOffset()),m=new Date(1e3*this.values.end+6e4*(new Date).getTimezoneOffset());this.tooltipText=this.formatTime(l,m)}function c(a,b,c,d){this.canvas=document.getElementById("schedule"),this.context=this.canvas.getContext("2d"),this.width=a,this.height=b,this.timeFormat=d,this.interval=c,this.context,this.hours=[["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],["12:00 AM","1:00 AM","2:00 AM","3:00 AM","4:00 AM","5:00 AM","6:00 AM","7:00 AM","8:00 AM","9:00 AM","10:00 AM","11:00 AM","12:00 AM","1:00 PM","2:00 PM","3:00 PM","4:00 PM","5:00 PM","6:00 PM","7:00 PM","8:00 PM","9:00 PM","10:00 PM","12:00 PM"]],this.show=function(){this.width=a,this.height=b,this.canvas.width=this.width,this.canvas.height=this.height;var c=this.interval;this.context.save(),this.context.beginPath(),this.context.fillStyle="rgba(255, 255, 255, 1)",this.context.rect(0,0,this.width,this.height-14),this.context.fill(),this.context.closePath();for(var d=0;d<24;d++)this.context.beginPath(),this.context.strokeStyle="rgba(192, 192, 192, .5)",this.context.moveTo(c,0),this.context.lineTo(c,this.height-14),this.context.stroke(),this.context.closePath(),this.context.beginPath(),this.context.font="italic 10pt Calibri",this.context.fillStyle="rgba(45, 49, 66, 1)",this.context.fillText(this.hours[0][d],c-this.context.measureText(this.hours[0][d]).width/2,this.height-2),this.context.closePath(),c+=this.interval;c=this.interval/2;for(var d=0;d<25;d++)this.context.beginPath(),this.context.strokeStyle="rgba(192, 192, 192, .25)",this.context.moveTo(c,0),this.context.lineTo(c,this.height-10),this.context.stroke(),this.context.closePath(),c+=this.interval;this.context.restore()}}var d={publicMethods:["update","filter","filterCustom"],className:"SlyckSchedule"},e=function(a,b){var c=this;return c.data=a,c.interval=60,c.width=25*c.interval,c.height=void 0,c.current=void 0,c.filterItem="All",c.filterItemCustom="All",c.status=void 0,c.tt={x:0,y:0},c.cards=[],c.rows=[],c.backup=[],c.scale={x:0,y:0},c.border={},c.hours=[["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],["12:00 AM","1:00 AM","2:00 AM","3:00 AM","4:00 AM","5:00 AM","6:00 AM","7:00 AM","8:00 AM","9:00 AM","10:00 AM","11:00 AM","12:00 AM","1:00 PM","2:00 PM","3:00 PM","4:00 PM","5:00 PM","6:00 PM","7:00 PM","8:00 PM","9:00 PM","10:00 PM","12:00 PM"]],c.settings={debug:!1,id:void 0,data:{label:void 0,time:{start:void 0,end:void 0}},filter:{field:"course"},card:{tooltip:!0,onClick:void 0,space:2,size:15,label:{size:10}},graph:{colors:{background:[255,255,255,1],border:[192,192,192,.5],sixty:[192,192,192,.5],thirty:[192,192,192,.25],time:[45,49,66,1]},font:{size:10},time:{format:"24"}}},c.settings=this.mergeSettings(c.settings,b),"undefined"==typeof c.settings.data.label?void(c.settings.debug&&(console.error("No Data Label Set"),console.error("Data Label Must be Set or we can not label the card"))):"undefined"==typeof c.settings.data.time?void(c.settings.debug&&(console.error("No Data Times Set"),console.error("Data Times Must be Set or we can not place a card"))):"undefined"==typeof c.settings.data.time.start?void(c.settings.debug&&(console.error("No Data Time Start Set"),console.error("Data Label Must be Set or we can not place a card"))):"undefined"==typeof c.settings.data.time.end?void(c.settings.debug&&(console.error("No Data Time End Set"),console.error("Data Time End Must be Set or we can not place a card"))):(c.settings.card.size<15&&(c.settings.debug&&(console.error("15 is the min size for the cards"),console.info("Setting size to 15")),c.settings.card.size=15),c.settings.card.space<2&&(c.settings.debug&&(console.error("2 is the min space for the cards"),console.info("Setting space to 2")),c.settings.card.space=2),c.settings.card.label.size>=c.settings.card.size&&(c.settings.debug&&(console.error("Card label size is too big for card size"),console.info("Resized card label size to fit as big as possible in card")),c.settings.card.label.size=c.settings.card.size-8),this.init(),this.draw(),this)};e.prototype={mergeSettings:function(a,b){for(var c in b)if(a.hasOwnProperty(c))try{b[c].constructor==Object?a[c]=this.mergeSettings(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a},init:function(){var a=this;if(this.slyck=void 0,"undefined"==typeof this.settings.id){if(this.slyck=document.getElementsByTagName("slyck-schedule")[0],"undefined"==typeof this.slyck)return void(a.settings.debug&&console.error("<slyck-schedule></slyck-schedule> Container not Found!"))}else if(this.slyck=document.getElementById(this.settings.id),"undefined"==typeof this.slyck)return void(a.settings.debug&&console.error(this.settings.id+" could not Found!"));for(a.slyck.className="slyck-schedule";a.slyck.firstChild;)a.slyck.removeChild(a.slyck.firstChild);a.canvas=document.createElement("canvas"),a.context=a.canvas.getContext("2d"),a.canvas.id="schedule",a.marginLeft,this.width<this.slyck.offsetWidth?a.marginLeft=0:a.marginLeft=-(this.width/2-this.slyck.offsetWidth/2),a.canvas.style.display="inline-block",a.canvas.style.marginLeft=a.marginLeft+"px",this.slyck.appendChild(a.canvas),this.load(this.data);var b,c=!1,d=!0;window.addEventListener("resize",function(){a.clear(),a.setup(),a.draw()},!1),this.canvas.addEventListener("mousedown",function(a){var e=a||event;c=!0,d=!0,b=e.clientX,a.preventDefault()}),this.canvas.addEventListener("mousemove",function(e){if(!(a.width<a.slyck.offsetWidth)){var f=e||event;if(c){d=!1;var g=f.clientX-b;b=f.clientX,a.marginLeft+=g,a.marginLeft>0&&(a.marginLeft=0),a.marginLeft<a.slyck.offsetWidth-a.width&&(a.marginLeft=a.slyck.offsetWidth-a.width),a.canvas.style.marginLeft=a.marginLeft+"px"}e.preventDefault()}},!1),this.canvas.addEventListener("mouseup",function(){c=!1},!1),this.canvas.addEventListener("mousemove",function(b){if(a.settings.card.tooltip){for(var c=(a.slyck.getBoundingClientRect(),a.canvas.getBoundingClientRect()),d=b.pageX-c.left-window.scrollX,e=b.pageY-c.top-window.scrollY,f=!1,g=0;g<a.cards.length;g++)if(d<a.cards[g].right&&d>a.cards[g].left&&e>a.cards[g].top&&e<a.cards[g].bottom){a.tt.x=d,a.tt.y=e,a.current=a.cards[g],a.canvas.style.cursor="pointer",f=!0;break}f||(a.current=void 0,a.canvas.style.cursor="default"),a.draw()}},!1),this.canvas.addEventListener("click",function(b){if(d){if("undefined"==typeof a.settings.card.onClick)return void(a.settings.debug&&(console.error("Missing Card onClick Function"),console.info("The Card onClick functions lets you pass the data to a function when the user clicks on its card")));for(var c=(a.slyck.getBoundingClientRect(),a.canvas.getBoundingClientRect()),e=b.pageX-c.left-window.scrollX,f=b.pageY-c.top-window.scrollY,g=0;g<a.cards.length;g++)if(e<a.cards[g].right&&e>a.cards[g].left&&f>a.cards[g].top&&f<a.cards[g].bottom){a.settings.card.onClick(a.cards[g].data);break}}d=!0},!1)},load:function(a){var c=[];c=this.cards,this.cards=[];var d=0;for(var e in a){var f,g,h,i=this.getValues(a[e]),j=new Date(1e3*i.start+6e4*(new Date).getTimezoneOffset()),k=new Date(1e3*i.end+6e4*(new Date).getTimezoneOffset()),l=j.getHours()*this.interval+this.interval+j.getMinutes(),m=k.getHours()*this.interval+this.interval+k.getMinutes(),n=-1,o=[];for(var p in this.cards)this.cards[p].values.label==i.label&&o.push(p);if(o.length>0&&(n=o[0]),n<0){var q=Math.floor(255*Math.random()+1),r=Math.floor(255*Math.random()+1),s=Math.floor(255*Math.random()+1);f=q+", "+r+", "+s,g=q+", "+r+", "+s}if(n>=0&&(f=this.cards[n].fill,g=this.cards[n].stroke),0!=c.length){var t;for(var u in c)if(c[u].values.label==i.label){t=u;break}t>=0&&(f=c[t].fill,g=c[t].stroke)}if(o.length>0)for(var h,v=[],p=0;p<o.length;p++)h=this.cards[o[p]].row-1,v.indexOf(h)<0&&(v.push(h),n=l>=this.cards[o[p]].left&&l<=this.cards[o[p]].right?-1:h);n<0?(n=d+1,d++):n++;var w=n*this.settings.card.size+n*(2*this.settings.card.space),x=new b(l,m,w,w+this.settings.card.size,this.settings.card.size,a[e],i,n,1,f,g);this.cards.push(x)}this.rows=d,this.setup()},setup:function(){var a=this.rows+2;this.height=a*this.settings.card.size+(a+2)*(2*this.settings.card.space);var b=this.slyck.getElementsByClassName("slyck-schedule-ui")[0];b&&this.slyck.removeChild(b),this.container=document.createElement("div"),this.container.className="slyck-schedule-ui",this.container.style.width=this.width<this.slyck.offsetWidth?this.width+"px":this.slyck.offsetWidth-2+"px",this.container.style.height=this.height-14+"px",this.container.style.border="rgba(192, 192, 192, .5) solid 1px",this.slyck.insertBefore(this.container,this.slyck.firstChild),this.graph=new c(this.width,this.height,this.interval,1)},draw:function(){this.graph.show();for(var a in this.cards)"All"!=this.filterItem&&this.cards[a].values.label!=this.filterItem||"All"!=this.filterItemCustom&&this.cards[a].values.filter!=this.filterItemCustom?this.cards[a].focus=!1:this.cards[a].focus=!0,this.cards[a].show(),this.settings.card.tooltip&&"undefined"!=typeof this.current&&this.current.tooltip(this.tt.x,this.tt.y)},update:function(a){this.load(a),this.clear(),this.draw()},filterCustom:function(a){this.filterItemCustom=a,this.clear(),this.draw()},filter:function(a){this.filterItem=a,this.clear(),this.draw()},clear:function(){this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.restore()},getValues:function(a){var b={};for(var c in a)c==this.settings.data.label&&(b.label=a[c]),c==this.settings.data.time.start&&(b.start=a[c]),c==this.settings.data.time.end&&(b.end=a[c]),c==this.settings.filter.field&&(b.filter=a[c]);return b}},a[d.className]=function(){function a(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}var b=a(e,arguments),c=function(){};return c.prototype={},Array.prototype.forEach.call(d.publicMethods,function(a){c.prototype[a]=function(){return b[a].apply(b,arguments)}}),new c(arguments)}}(this);