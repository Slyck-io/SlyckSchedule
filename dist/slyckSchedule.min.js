!function(a){"use strict";var b={publicMethods:["update"],className:"SlyckSchedule"},c=function(a,b){var c=this;return c.data=a,c.ratio=void 0,c.width=1500,c.height=void 0,c.current=void 0,c.tt={x:0,y:0},c.cards=[],c.rows=[],c.interval=60,c.scale={x:0,y:0},c.count={stroke:0,fill:0},c.border={},c.hours=[["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],["12:00 AM","1:00 AM","2:00 AM","3:00 AM","4:00 AM","5:00 AM","6:00 AM","7:00 AM","8:00 AM","9:00 AM","10:00 AM","11:00 AM","12:00 AM","1:00 PM","2:00 PM","3:00 PM","4:00 PM","5:00 PM","6:00 PM","7:00 PM","8:00 PM","9:00 PM","10:00 PM","12:00 PM"]],c.settings={id:void 0,data:{label:void 0,time:{start:void 0,end:void 0}},debug:!1,card:{tooltip:!0,onClick:void 0,space:2,size:15,label:{size:10,color:[45,49,66,1]},colors:[[33,150,243,.5]],strokes:[[33,150,243,1]]},graph:{colors:{background:[255,255,255,1],border:[192,192,192,.5],sixty:[192,192,192,.5],thirty:[192,192,192,.25],time:[45,49,66,1]},font:{size:10},time:{format:"24"}}},c.settings=this.mergeSettings(c.settings,b),"undefined"==typeof c.settings.data.label?void(c.settings.debug&&(console.error("No Data Label Set"),console.error("Data Label Must be Set or we can not label the card"))):"undefined"==typeof c.settings.data.time?void(c.settings.debug&&(console.error("No Data Times Set"),console.error("Data Times Must be Set or we can not place a card"))):"undefined"==typeof c.settings.data.time.start?void(c.settings.debug&&(console.error("No Data Time Start Set"),console.error("Data Label Must be Set or we can not place a card"))):"undefined"==typeof c.settings.data.time.end?void(c.settings.debug&&(console.error("No Data Time End Set"),console.error("Data Time End Must be Set or we can not place a card"))):(c.settings.card.size<15&&(c.settings.debug&&(console.error("15 is the min size for the cards"),console.info("Setting size to 15")),c.settings.card.size=15),c.settings.card.space<2&&(c.settings.debug&&(console.error("2 is the min space for the cards"),console.info("Setting space to 2")),c.settings.card.space=2),c.settings.card.label.size>=c.settings.card.size&&(c.settings.debug&&(console.error("Card label size is too big for card size"),console.info("Resized card label size to fit as big as possible in card")),c.settings.card.label.size=c.settings.card.size-8),this.init(),this)};c.prototype={init:function(){var a=this;if(this.slyck=void 0,"undefined"==typeof this.settings.id){if(this.slyck=document.getElementsByTagName("slyck-schedule")[0],"undefined"==typeof this.slyck)return void(a.settings.debug&&console.error("<slyck-schedule></slyck-schedule> Container not Found!"))}else if(this.slyck=document.getElementById(this.settings.id),"undefined"==typeof this.slyck)return void(a.settings.debug&&console.error(this.settings.id+" could not Found!"));for(a.slyck.className="slyck-schedule";a.slyck.firstChild;)a.slyck.removeChild(a.slyck.firstChild);if(a.canvas=document.createElement("canvas"),a.context=a.canvas.getContext("2d"),this.canvas.id="schedule",this.marginLeft=-(this.width/2-this.slyck.offsetWidth/2),this.canvas.style.display="inline-block",this.canvas.style.marginLeft=a.marginLeft+"px",this.slyck.appendChild(this.canvas),this.checkColors(),"24"==this.settings.graph.time.format)this.settings.graph.time.format=0;else{if("12"!=this.settings.graph.time.format)return void(a.settings.debug&&(console.error("Unsupport Time Formatting"),console.info("12 = 12 Hours AM/PM or 24 = 24 Hours 0000-2300")));this.settings.graph.time.format=1}this.layout=this.layout.bind(this),this.draw=this.draw.bind(this),this.clear=this.clear.bind(this),this.reDraw=this.reDraw.bind(this),window.addEventListener("resize",a.reDraw,!1);var b,c=!1,d=!0;this.canvas.addEventListener("mousedown",function(a){var e=a||event;c=!0,d=!0,b=e.clientX,a.preventDefault()}),this.canvas.addEventListener("mousemove",function(e){var f=e||event;if(c){d=!1;var g=f.clientX-b;b=f.clientX,a.marginLeft+=g,a.marginLeft>0&&(a.marginLeft=0),a.marginLeft<a.slyck.offsetWidth-a.width&&(a.marginLeft=a.slyck.offsetWidth-a.width),a.canvas.style.marginLeft=a.marginLeft+"px"}e.preventDefault()},!1),this.canvas.addEventListener("mouseup",function(){c=!1},!1),this.canvas.addEventListener("mousemove",function(b){if(a.settings.card.tooltip){for(var c=(a.slyck.getBoundingClientRect(),a.canvas.getBoundingClientRect()),d=b.pageX-c.left-window.scrollX,e=b.pageY-c.top-window.scrollY,f=!1,g=0;g<a.cards.length;g++)if(d<a.cards[g].right&&d>a.cards[g].left&&e>a.cards[g].top&&e<a.cards[g].bottom){a.tt.x=d,a.tt.y=e,a.current=a.cards[g],a.canvas.style.cursor="pointer",f=!0;break}f||(a.current=void 0,a.canvas.style.cursor="default"),a.reDraw()}},!1),this.canvas.addEventListener("click",function(b){if(d){if("undefined"==typeof a.settings.card.onClick)return void(a.settings.debug&&(console.error("Missing Card onClick Function"),console.info("The Card onClick functions lets you pass the data to a function when the user clicks on its card")));for(var c=a.canvas.getBoundingClientRect(),e=b.pageX-c.left-window.scrollX,f=b.pageY-c.top-window.scrollY,g=(0!=a.scale.x?a.scale.x:1,0!=a.scale.y?a.scale.y:1,0);g<a.cards.length;g++)if(e<a.cards[g].right&&e>a.cards[g].left&&f>a.cards[g].top&&f<a.cards[g].bottom){a.settings.card.onClick(a.cards[g].data);break}}d=!0},!1),a.load(a.data),a.layout(),a.draw()},mergeSettings:function(a,b){for(var c in b)if(a.hasOwnProperty(c))try{b[c].constructor==Object?a[c]=this.mergeSettings(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a},getCardColor:function(a,b){return"fill"==b?4==this.settings.card.colors[a].length?"rgba("+this.settings.card.colors[a][0]+", "+this.settings.card.colors[a][1]+", "+this.settings.card.colors[a][2]+", "+this.settings.card.colors[a][3]+")":3==this.settings.card.colors[a].length?"rgb("+this.settings.card.colors[a][0]+", "+this.settings.card.colors[a][1]+","+this.settings.card.colors[a][2]+")":1==this.settings.card.colors[a].length?""+this.settings.card.colors[a]:void(self.settings.debug&&(console.error("Unsupport Card Fill Color"),console.info("Support Colors are HEX, RGB, RGBA"))):"stroke"==b?4==this.settings.card.strokes[a].length?"rgba("+this.settings.card.strokes[a][0]+", "+this.settings.card.strokes[a][1]+", "+this.settings.card.strokes[a][2]+", "+this.settings.card.strokes[a][3]+")":3==this.settings.card.strokes[a].length?"rgb("+this.settings.card.strokes[a][0]+", "+this.settings.card.strokes[a][1]+","+this.settings.card.strokes[a][2]+")":1==this.settings.card.strokes[a].length?""+this.settings.card.strokes[a]:void(self.settings.debug&&(console.error("Unsupport Card Stroke Color"),console.info("Support Colors are HEX, RGB, RGBA"))):void 0},checkColors:function(){if(4==this.settings.graph.colors.background.length)this.settings.graph.colors.background="rgba("+this.settings.graph.colors.background[0]+", "+this.settings.graph.colors.background[1]+", "+this.settings.graph.colors.background[2]+", "+this.settings.graph.colors.background[3]+")";else if(3==this.settings.graph.colors.background.length)this.settings.graph.colors.background="rgb("+this.settings.graph.colors.background[0]+", "+this.settings.graph.colors.background[1]+","+this.settings.graph.colors.background[2]+")";else{if(1!=this.settings.graph.colors.background.length)return void(self.settings.debug&&(console.error("Unsupport Background Fill Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.graph.colors.background=""+this.settings.graph.colors.background}if(4==this.settings.card.label.color.length)this.settings.card.label.color="rgba("+this.settings.card.label.color[0]+", "+this.settings.card.label.color[1]+", "+this.settings.card.label.color[2]+", "+this.settings.card.label.color[3]+")";else if(3==this.settings.card.label.color.length)this.settings.card.label.color="rgb("+this.settings.card.label.color[0]+", "+this.settings.card.label.color[1]+","+this.settings.card.label.color[2]+")";else{if(1!=this.settings.card.label.color.length)return void(self.settings.debug&&(console.error("Unsupport Card Label Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.card.label.color=""+this.settings.card.label.color}if(4==this.settings.graph.colors.border.length)this.settings.graph.colors.border="rgba("+this.settings.graph.colors.border[0]+", "+this.settings.graph.colors.border[1]+", "+this.settings.graph.colors.border[2]+", "+this.settings.graph.colors.border[3]+")";else if(3==this.settings.graph.colors.border.length)this.settings.graph.colors.border="rgb("+this.settings.graph.colors.border[0]+", "+this.settings.graph.colors.border[1]+","+this.settings.graph.colors.border[2]+")";else{if(1!=this.settings.graph.colors.border.length)return void(self.settings.debug&&(console.error("Unsupport Border Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.graph.colors.border=""+this.settings.graph.colors.border}if(4==this.settings.graph.colors.sixty.length)this.settings.graph.colors.sixty="rgba("+this.settings.graph.colors.sixty[0]+", "+this.settings.graph.colors.sixty[1]+", "+this.settings.graph.colors.sixty[2]+", "+this.settings.graph.colors.sixty[3]+")";else if(3==this.settings.graph.colors.sixty.length)this.settings.graph.colors.sixty="rgb("+this.settings.graph.colors.sixty[0]+", "+this.settings.graph.colors.sixty[1]+","+this.settings.graph.colors.sixty[2]+")";else{if(1!=this.settings.graph.colors.sixty.length)return void(self.settings.debug&&(console.error("Unsupport Sixty Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.graph.colors.sixty=""+this.settings.graph.colors.sixty}if(4==this.settings.graph.colors.thirty.length)this.settings.graph.colors.thirty="rgba("+this.settings.graph.colors.thirty[0]+", "+this.settings.graph.colors.thirty[1]+", "+this.settings.graph.colors.thirty[2]+", "+this.settings.graph.colors.thirty[3]+")";else if(3==this.settings.graph.colors.thirty.length)this.settings.graph.colors.thirty="rgb("+this.settings.graph.colors.thirty[0]+", "+this.settings.graph.colors.thirty[1]+","+this.settings.graph.colors.thirty[2]+")";else{if(1!=this.settings.graph.colors.thirty.length)return void(self.settings.debug&&(console.error("Unsupport Thirty Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.graph.colors.thirty=""+this.settings.graph.colors.thirty}if(4==this.settings.graph.colors.time.length)this.settings.graph.colors.time="rgba("+this.settings.graph.colors.time[0]+", "+this.settings.graph.colors.time[1]+", "+this.settings.graph.colors.time[2]+", "+this.settings.graph.colors.time[3]+")";else if(3==this.settings.graph.colors.time.length)this.settings.graph.colors.time="rgb("+this.settings.graph.colors.time[0]+", "+this.settings.graph.colors.time[1]+","+this.settings.graph.colors.time[2]+")";else{if(1!=this.settings.graph.colors.time.length)return void(self.settings.debug&&(console.error("Unsupport Time Color"),console.info("Support Colors are HEX, RGB, RGBA")));this.settings.graph.colors.time=""+this.settings.graph.colors.time}},Card:function(a,b,c,d,e,f){return{left:a,top:b,right:a+c,bottom:b+d,values:e,data:f}},getOffset:function(a){return a?a*this.settings.card.space*2+this.settings.card.size:this.settings.card.size},getValues:function(a){var b,c={};for(b in a)b==this.settings.data.label&&(c.label=a[b]),b==this.settings.data.time.start&&(c.start=a[b]),b==this.settings.data.time.end&&(c.end=a[b]);return c},load:function(a){for(var b,c=this.rows,d=0;d<a.length;d++){if(b=this.getValues(a[d]),0==d){if("undefined"==typeof b.label)return void(self.settings.debug&&(console.error("No Data Label Found"),console.error("Data Label Must be Found or we can not label the card")));if("undefined"==typeof b.start)return void(self.settings.debug&&(console.error("No Data Start Found"),console.error("Data Start Must be Found or we can not label the card")));if("undefined"==typeof b.end)return void(self.settings.debug&&(console.error("No Data End Found"),console.error("Data End Must be Found or we can not label the card")))}var e=new Date(1e3*b.start+6e4*(new Date).getTimezoneOffset()),f=new Date(1e3*b.end+6e4*(new Date).getTimezoneOffset()),g=e.getHours()*this.interval+this.interval+e.getMinutes(),h=f.getHours()*this.interval+this.interval+f.getMinutes(),i=0,j=!1;if(c.length)for(var k=0;k<c.length;k++){for(var l=0;l<c[k].length;l++)if(c[k][l].start==g||c[k][l].start<g&&c[k][l].end>g||c[k][l].start<h&&c[k][l].end>h||c[k][l].start<g&&c[k][l].end>h||c[k][l].start>g&&c[k][l].end<h){i++,j=!0;break}if(!j&&i==k)break;j=!1}c[i]||c.push(new Array);var m=this.Card(g,this.getOffset(i)+i*this.settings.card.size,h-g,this.settings.card.size,b,a[d]);c[i].push({start:g,end:h,card:m}),this.cards.push(m)}this.rows=c},layout:function(){var a=this.context,b=this.interval;this.canvas.width=this.width,this.canvas.height=this.slyck.offsetHieght,"undefined"==typeof this.height&&(this.height=this.rows.length+(this.rows.length+2)*this.settings.card.size+this.rows.length*this.settings.card.space+this.settings.card.space+(this.settings.graph.font.size+4)),this.canvas.height=this.height;var c=this.slyck.getElementsByClassName("slyck-schedule-ui")[0];c&&this.slyck.removeChild(c),this.container=document.createElement("div"),this.container.className="slyck-schedule-ui",this.container.style.width=this.slyck.offsetWidth-2+"px",this.container.style.height=this.height-(this.settings.graph.font.size+4)+"px",this.container.style.border=this.settings.graph.colors.border+" solid 1px",this.slyck.insertBefore(this.container,this.slyck.firstChild);var d=this.slyck.getElementsByClassName("end-right")[0];d&&this.slyck.removeChild(d),this.timeRight=document.createElement("span"),this.timeRight.className="end-right",this.timeRight.style.marginLeft=this.slyck.offsetWidth-60+"px",this.timeRight.style.height=this.height-(this.settings.graph.font.size+4)+"px",this.slyck.insertBefore(this.timeRight,this.slyck.firstChild);var e=this.slyck.getElementsByClassName("end-left")[0];e&&this.slyck.removeChild(e),this.timeLeft=document.createElement("span"),this.timeLeft.className="end-left",this.timeLeft.style.height=this.height-(this.settings.graph.font.size+4)+"px",this.slyck.insertBefore(this.timeLeft,this.slyck.firstChild),a.save(),a.beginPath(),a.fillStyle=this.settings.graph.colors.background,a.rect(0,0,this.width,this.height-(this.settings.graph.font.size+4)),a.fill(),a.closePath();for(var f=0;f<24;f++)a.beginPath(),a.strokeStyle=this.settings.graph.colors.sixty,a.moveTo(b,0),a.lineTo(b,this.height-(this.settings.graph.font.size+4)),a.stroke(),a.closePath(),a.beginPath(),a.font="italic "+this.settings.graph.font.size+"pt Calibri",a.fillStyle=this.settings.graph.colors.time,a.fillText(this.hours[this.settings.graph.time.format][f],b-a.measureText(this.hours[this.settings.graph.time.format][f]).width/2,this.height-2),a.closePath(),b+=this.interval;b=this.interval/2;for(var f=0;f<25;f++)a.beginPath(),a.strokeStyle=this.settings.graph.colors.thirty,a.moveTo(b,0),a.lineTo(b,this.height-10),a.stroke(),a.closePath(),b+=this.interval;a.restore()},draw:function(){var a=this.context;this.count.stroke=0,this.count.fill=0,a.save();for(var b=0;b<this.rows.length;b++)for(var c=0;c<this.rows[b].length;c++)this.drawCard(this.rows[b][c].card,b),this.count.stroke=(this.count.stroke+1)%this.settings.card.strokes.length,this.count.fill=(this.count.fill+1)%this.settings.card.colors.length;if(this.settings.card.tooltip&&"undefined"!=typeof this.current){var d,e=new Date(1e3*this.current.values.start+6e4*(new Date).getTimezoneOffset()),f=new Date(1e3*this.current.values.end+6e4*(new Date).getTimezoneOffset());if(0==this.settings.graph.time.format){var g=e.getHours(),h=e.getMinutes();h=h<10?"0"+h:h;var i=g<=12?"am":"pm";"pm"==i&&(g-=12);var j=g+":"+h+" "+i;g=f.getHours(),h=f.getMinutes(),h=h<10?"0"+h:h,i=g<=12?"am":"pm","pm"==i&&(g-=12);var k=g+":"+h+" "+i;d=j+" til "+k}if(1==this.settings.graph.time.format){var g=e.getHours(),h=e.getMinutes();h=h<10?"0"+h:h;var j=g+":"+h;g=f.getHours(),h=f.getMinutes(),h=h<10?"0"+h:h;var k=g+":"+h;d=j+" til "+k}var l=a.measureText(d).width+10,m=25,n=this.tt.x-l-2,o=this.tt.y-m,p=5,q=n+5,r=m+o-this.settings.card.label.size/2-2;a.fillStyle="rgba(0, 0, 0, .5)",a.strokeStyle="rgba(0, 0, 0, 1)",a.lineWidth=1,a.beginPath(),a.moveTo(n+p,o),a.lineTo(n+l-p,o),a.quadraticCurveTo(n+l,o,n+l,o+p),a.lineTo(n+l,o+m-p),a.quadraticCurveTo(n+l,o+m,n+l-p,o+m),a.lineTo(n+p,o+m),a.quadraticCurveTo(n,o+m,n,o+m-p),a.lineTo(n,o+p),a.quadraticCurveTo(n,o,n+p,o),a.closePath(),a.stroke(),a.fill(),a.beginPath(),a.font=this.settings.card.label.size+"pt Calibri",a.fillStyle="rgba(255, 255, 255, 1)",a.fillText(d,q,r),a.closePath()}a.restore()},drawCard:function(a,b){var c,d,e=this.context,f=this.getOffset(b);e.beginPath(),e.rect(a.left,f+b*this.settings.card.size,a.right-a.left,this.settings.card.size),e.lineWidth=1,e.strokeStyle=this.settings.card.strokes.length>1?this.getCardColor(this.count.stroke,"stroke"):this.getCardColor(0,"stroke"),e.stroke(),e.fillStyle=this.settings.card.colors.length>1?this.getCardColor(this.count.fill,"fill"):this.getCardColor(0,"fill"),e.fill(),e.closePath(),e.beginPath(),e.font=this.settings.card.label.size+"pt Calibri",e.fillStyle=this.settings.card.label.color,(e.measureText(a.values.label).width>=a.right-a.left||a.right-a.left-e.measureText(a.values.label).width<5)&&(self.settings.debug&&console.error("Label width then or equal to card width or within 5"),this.settings.card.label.size-=5,this.redraw()),c=(a.right-a.left)/2+a.left-e.measureText(a.values.label).width/2,d=(a.top-a.bottom)/2+a.bottom+this.settings.card.label.size/2,a.values.label.indexOf("y")!=-1&&(d-=this.settings.card.size/10),e.fillText(a.values.label,c,d),e.closePath()},clear:function(){this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.restore()},reDraw:function(){this.clear(),this.layout(),this.draw()},update:function(a){this.data=a,this.rows=[],this.cards=[],this.height=void 0,this.load(a),this.reDraw()}},a[b.className]=function(){function a(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}var d=a(c,arguments),e=function(){};return e.prototype={},Array.prototype.forEach.call(b.publicMethods,function(a){e.prototype[a]=function(){return d[a].apply(d,arguments)}}),new e(arguments)}}(this);